<?php

include __DIR__ . '/MalwareDomain.php';

$config = array(
    'api_key' => 'API_KEY',
    'file.path' => __DIR__ . DIRECTORY_SEPARATOR . 'domains.txt',
	'file.iterationLimit' => 480,
    'request.data' => array(
        'client' => array(
            'clientId' => 'TestClient',
            'clientVersion' => '0.0.1'
        ),
        'threatInfo' => array(
            'threatTypes' => array('MALWARE', 'SOCIAL_ENGINEERING', 'THREAT_TYPE_UNSPECIFIED', 'UNWANTED_SOFTWARE', 'POTENTIALLY_HARMFUL_APPLICATION'),
            'platformTypes' => array('LINUX', 'WINDOWS', 'ANDROID', 'OSX', 'IOS', 'ANY_PLATFORM', 'ALL_PLATFORMS', 'CHROME', 'PLATFORM_TYPE_UNSPECIFIED'),
            'threatEntryTypes' => array('URL', 'IP_RANGE', 'THREAT_ENTRY_TYPE_UNSPECIFIED', 'EXECUTABLE'),
        )
    ),
    'request.urls' => array(
        'find' => 'https://safebrowsing.googleapis.com/v4/threatMatches:find'
    )
);

$md = new MalwareDomain($config);

$md->checkDomains();

//var_dump($md->getAllErrors());
//var_dump($md->getDomainsWithErrors());
//var_dump($md->getDomainErrors('sportlemon.online'));


//$md->addDomain([
//    'domain.com'
//]);